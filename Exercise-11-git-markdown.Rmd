---
title: "Exercise-11-git-markdown"
author: "MM"
date: "2024-12-20"
output: github_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Downloading packages

```{r, eval=TRUE, results = "hide", echo=TRUE}
library(tidyverse)
library(dplyr)
library(broom)
library(haven)
x<-read_sav("data/ESS9e03_2.sav")
```



# Having a look at the dataset
```{r, eval=TRUE, echo=TRUE}
head(x)
```


# Recoding the variables
### finding the variables in the documentation :
 age -> agea</br>
 sex -> gndr -> to recode : 1 female; 0 male </br>
 employment relationship -> emplrel</br>
 marital status -> marsts -> to be recoded into 3 groups</br>
 subjective income -> hincfel</br>
 religious attendance -> rlgatnd _> recode</br>

## Selecting the variable we need and creating a dataset
```{r, eval=TRUE, results = "hide", echo=TRUE}
df<-select(x,
           age = agea,
           sex = gndr,
           emplrel,
           marsts,
           subjinc = hincfel,
           rlgatnd,
           cntry
           )
```
quickly exploring the variables in question
```{r, eval=TRUE, echo=TRUE}
table(as_factor(df$sex))
table(df$sex)
```
since female is coded as 2, and male as 1 we can just -1
```{r, eval=TRUE, results = "hide", echo=TRUE}
df<-mutate(df, sex=sex-1)
```
```{r, eval=TRUE, echo=TRUE}
table(df$sex)
table(df$emplrel)
df.emplrel<-as.factor(df$emplrel)
table(as_factor(df$marsts))
table(df$marsts)
```
### Recoding marital status :
1or2;3or4or5;6or66or77or88or99</br>
Eventually this code will transform NA into 3rd category</br>
There haven't been restrictions about that so we keep it !
```{r, eval=TRUE, results = "hide", echo=TRUE}
df<-mutate(df,marsts=ifelse(marsts %in% c(1,2),1,
                            ifelse(marsts %in% c(3,4,5),2,3)))
table(df$marsts)
```
### Reconding religion attendance
```{r, eval=TRUE, results = "hide", echo=FALSE}
table(as_factor(df$rlgatnd))
table(df$rlgatnd)
```
```{r, eval=TRUE, echo=TRUE}
df<-mutate(df,rlgatnd = 7-rlgatnd)
table(df$rlgatnd)
```
# [QUESTION 2.1] Report the percentage of females in the sample : 53.51%
```{r, eval=TRUE, results = "hide", echo=TRUE}
female<-round(nrow(filter(df,sex==1))/nrow(df),4)*100
```
```{r, eval=TRUE, echo=FALSE}
female
```


## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
